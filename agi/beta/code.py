# agi

{
    "files": [
        {
            "filename": "agi/core/agent.py",
            "content": "import os\nimport json\nfrom typing import List, Dict, Any, Optional\nfrom openai import OpenAI\nfrom agi.core.memory import Memory\nfrom agi.core.planner import Planner\n\nclass AGIAgent:\n    \"\"\"\n    核心AGI代理类，负责协调记忆、规划和与OpenAI API的交互。\n    实现基本的推理、记忆存储和任务执行能力。\n    \"\"\"\n    \n    def __init__(self, api_key: Optional[str] = None, model: str = \"gpt-4\"):\n        \"\"\"\n        初始化AGI代理。\n        \n        Args:\n            api_key (str, optional): OpenAI API密钥。如果未提供，则从环境变量OPENAI_API_KEY读取。\n            model (str): 使用的OpenAI模型，默认为gpt-4。\n        \"\"\"\n        self.api_key = api_key or os.getenv(\"OPENAI_API_KEY\")\n        if not self.api_key:\n            raise ValueError(\"OpenAI API key must be provided either as argument or in OPENAI_API_KEY environment variable.\")\n        \n        self.client = OpenAI(api_key=self.api_key)\n        self.model = model\n        self.memory = Memory()\n        self.planner = Planner(self)\n    \n    def think(self, query: str, context: Optional[List[Dict[str, str]]] = None) -> str:\n        \"\"\"\n        处理用户查询，结合记忆和上下文进行推理。\n        \n        Args:\n            query (str): 用户输入的问题或指令。\n            context (List[Dict[str, str]], optional): 对话历史上下文。\n            \n        Returns:\n            str: 生成的回答。\n        \"\"\"\n        # 从记忆中检索相关信息\n        relevant_memories = self.memory.retrieve(query)\n        \n        # 构建系统提示\n        system_prompt = (\n            \"You are an advanced Artificial General Intelligence (AGI) capable of reasoning, \"\n            \"learning from interactions, and solving complex problems. Use the following \"\n            \"retrieved memories to inform your response:\\n\\n\"\n            f\"{relevant_memories}\\n\\n\"\n            \"Respond concisely and accurately. If you don't know something, say so.\"\n        )\n        \n        # 构建消息列表\n        messages = [{\"role\": \"system\", \"content\": system_prompt}]\n        if context:\n            messages.extend(context)\n        messages.append({\"role\": \"user\", \"content\": query})\n        \n        # 调用OpenAI API\n        response = self.client.chat.completions.create(\n            model=self.model,\n            messages=messages,\n            temperature=0.7,\n            max_tokens=1000\n        )\n        \n        answer = response.choices[0].message.content.strip()\n        \n        # 存储交互到记忆\n        self.memory.store({\n            \"query\": query,\n            \"response\": answer,\n            \"context\": context or []\n        })\n        \n        return answer\n    \n    def execute_task(self, task_description: str) -> str:\n        \"\"\"\n        执行复杂任务，通过规划分解为子任务。\n        \n        Args:\n            task_description (str): 任务描述。\n            \n        Returns:\n            str: 任务执行结果。\n        \"\"\"\n        return self.planner.execute(task_description)\n"
        },
        {
            "filename": "agi/core/memory.py",
            "content": "import json\nfrom typing import List, Dict, Any\n\nclass Memory:\n    \"\"\"\n    简单的记忆模块，用于存储和检索交互历史。\n    在实际AGI中应替换为更复杂的向量数据库或知识图谱。\n    \"\"\"\n    \n    def __init__(self):\n        self.storage: List[Dict[str, Any]] = []\n    \n    def store(self, entry: Dict[str, Any]) -> None:\n        \"\"\"\n        存储一个记忆条目。\n        \n        Args:\n            entry (Dict[str, Any]): 要存储的记忆数据。\n        \"\"\"\n        self.storage.append(entry)\n    \n    def retrieve(self, query: str, top_k: int = 3) -> str:\n        \"\"\"\n        基于关键词匹配检索相关记忆（简化版）。\n        在实际应用中应使用嵌入向量相似度搜索。\n        \n        Args:\n            query (str): 查询字符串。\n            top_k (int): 返回的最相关记忆数量。\n            \n        Returns:\n            str: 格式化的相关记忆文本。\n        \"\"\"\n        # 简化实现：返回最近的几条记忆\n        recent_memories = self.storage[-top_k:] if self.storage else []\n        \n        formatted = []\n        for mem in recent_memories:\n            formatted.append(f\"Q: {mem.get('query', '')}\\nA: {mem.get('response', '')}\")\n        \n        return \"\\n\\n\".join(formatted) if formatted else \"No relevant memories found.\"\n"
        },
        {
            "filename": "agi/core/planner.py",
            "content": "from typing import List, Dict, Any\nfrom agi.core.agent import AGIAgent\n\nclass Planner:\n    \"\"\"\n    任务规划模块，将复杂任务分解为可执行的子任务。\n    \"\"\"\n    \n    def __init__(self, agent: AGIAgent):\n        self.agent = agent\n    \n    def execute(self, task: str) -> str:\n        \"\"\"\n        执行任务规划和执行。\n        \n        Args:\n            task (str): 需要执行的任务描述。\n            \n        Returns:\n            str: 任务执行结果。\n        \"\"\"\n        # 使用LLM生成任务分解\n        planning_prompt = (\n            f\"Break down the following task into a sequence of simple, executable steps:\\n\\n\"\n            f\"Task: {task}\\n\\n\"\n            \"Respond with a numbered list of steps, one per line.\"\n        )\n        \n        steps_response = self.agent.client.chat.completions.create(\n            model=self.agent.model,\n            messages=[{\"role\": \"user\", \"content\": planning_prompt}],\n            temperature=0.3,\n            max_tokens=500\n        )\n        \n        steps_text = steps_response.choices[0].message.content.strip()\n        steps = [line.strip() for line in steps_text.split(\"\\n\") if line.strip()]\n        \n        results = []\n        for step in steps:\n            # 执行每个子任务\n            result = self.agent.think(f\"Execute this step: {step}\")\n            results.append(f\"Step: {step}\\nResult: {result}\")\n        \n        # 综合结果\n        summary_prompt = (\n            \"Summarize the following step-by-step execution results into a coherent final answer:\\n\\n\"\n            + \"\\n\\n\".join(results)\n        )\n        \n        summary_response = self.agent.client.chat.completions.create(\n            model=self.agent.model,\n            messages=[{\"role\": \"user\", \"content\": summary_prompt}],\n            temperature=0.5,\n            max_tokens=500\n        )\n        \n        return summary_response.choices[0].message.content.strip()\n"
        },
        {
            "filename": "agi/main.py",
            "content": "import os\nimport sys\nfrom agi.core.agent import AGIAgent\n\ndef main():\n    \"\"\"\n    主函数：初始化AGI代理并启动交互循环。\n    \"\"\"\n    try:\n        agent = AGIAgent()\n        print(\"AGI Agent initialized. Type 'exit' to quit.\")\n        \n        context = []\n        while True:\n            user_input = input(\"\\nUser: \").strip()\n            if user_input.lower() in ['exit', 'quit']:\n                print(\"Goodbye!\")\n                break\n            \n            if not user_input:\n                continue\n                \n            # 检查是否为复杂任务（包含多个步骤指示）\n            if any(keyword in user_input.lower() for keyword in [\"plan\", \"steps\", \"how to\", \"break down\"]):\n                response = agent.execute_task(user_input)\n            else:\n                response = agent.think(user_input, context)\n                # 更新上下文\n                context.append({\"role\": \"user\", \"content\": user_input})\n                context.append({\"role\": \"assistant\", \"content\": response})\n                # 限制上下文长度\n                if len(context) > 10:\n                    context = context[-10:]\n            \n            print(f\"\\nAGI: {response}\")\n            \n    except KeyboardInterrupt:\n        print(\"\\n\\nInterrupted by user. Goodbye!\")\n    except Exception as e:\n        print(f\"\\nError: {e}\", file=sys.stderr)\n        sys.exit(1)\n\nif __name__ == \"__main__\":\n    main()\n"
        },
        {
            "filename": "requirements.txt",
            "content": "openai>=1.0.0\n"
        },
        {
            "filename": "README.md",
            "content": "# AGI Project\n\n这是一个基于OpenAI API的通用人工智能（AGI）原型实现。\n\n## 功能特性\n\n- **核心推理**：通过OpenAI模型进行自然语言理解和生成\n- **记忆系统**：存储和检索交互历史以提供上下文感知\n- **任务规划**：将复杂任务分解为可执行的子步骤\n- **持续对话**：维护对话上下文以支持多轮交互\n\n## 安装\n\n1. 克隆仓库\n2. 安装依赖：`pip install -r requirements.txt`\n3. 设置OpenAI API密钥：\n   ```bash\n   export OPENAI_API_KEY='your-api-key-here'\n   ```\n\n## 使用\n\n运行主程序：\n```bash\npython -m agi.main\n```\n\n在交互界面中输入问题或指令。输入`exit`退出。\n\n## 架构说明\n\n- `agi/core/agent.py`: 核心AGI代理类\n- `agi/core/memory.py`: 记忆存储和检索模块\n- `agi/core/planner.py`: 任务规划和执行模块\n- `agi/main.py`: 主程序入口\n\n> **注意**：此项目为AGI概念验证原型。真正的AGI需要更复杂的认知架构、自主学习能力和多模态处理能力。\n"
        }
    ]
}"