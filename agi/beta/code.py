# agi

```json
{
    "files": [
        {
            "filename": "requirements.txt",
            "content": "# 项目依赖包\nopenai>=1.0.0\npython-dotenv>=1.0.0\nasyncio\n"
        },
        {
            "filename": "config.py",
            "content": "# AGI 配置文件\nimport os\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nclass Config:\n    \"\"\"AGI 配置类\"\"\"\n    \n    # OpenAI API 配置\n    OPENAI_API_KEY = os.getenv(\"OPENAI_API_KEY\")\n    OPENAI_MODEL = os.getenv(\"OPENAI_MODEL\", \"gpt-4\")\n    OPENAI_MAX_TOKENS = int(os.getenv(\"OPENAI_MAX_TOKENS\", 2048))\n    OPENAI_TEMPERATURE = float(os.getenv(\"OPENAI_TEMPERATURE\", 0.7))\n    \n    # AGI 配置\n    AGI_NAME = \"AGI Assistant\"\n    MEMORY_FILE = \"memory.json\"\n    \n    @classmethod\n    def validate_config(cls):\n        \"\"\"验证配置是否完整\"\"\"\n        if not cls.OPENAI_API_KEY:\n            raise ValueError(\"OPENAI_API_KEY 未设置，请在 .env 文件中配置\")\n        print(f\"配置加载完成，使用模型: {cls.OPENAI_MODEL}\")\n"
        },
        {
            "filename": "memory.py",
            "content": "# AGI 记忆模块\nimport json\nimport os\nfrom datetime import datetime\n\nclass MemoryManager:\n    \"\"\"记忆管理器类\"\"\"\n    \n    def __init__(self, memory_file=\"memory.json\"):\n        \"\"\"初始化记忆管理器\"\"\"\n        self.memory_file = memory_file\n        self.memories = []\n        self.load_memory()\n    \n    def load_memory(self):\n        \"\"\"从文件加载记忆\"\"\"\n        if os.path.exists(self.memory_file):\n            try:\n                with open(self.memory_file, 'r', encoding='utf-8') as f:\n                    self.memories = json.load(f)\n                print(f\"已加载 {len(self.memories)} 条记忆\")\n            except (json.JSONDecodeError, FileNotFoundError):\n                self.memories = []\n                print(\"记忆文件损坏或不存在，创建新记忆库\")\n        else:\n            self.memories = []\n            print(\"创建新记忆库\")\n    \n    def save_memory(self):\n        \"\"\"保存记忆到文件\"\"\"\n        try:\n            with open(self.memory_file, 'w', encoding='utf-8') as f:\n                json.dump(self.memories, f, ensure_ascii=False, indent=2)\n            print(f\"已保存 {len(self.memories)} 条记忆\")\n        except Exception as e:\n            print(f\"保存记忆失败: {e}\")\n    \n    def add_memory(self, role, content, metadata=None):\n        \"\"\"添加新的记忆\"\"\"\n        memory = {\n            \"id\": len(self.memories) + 1,\n            \"role\": role,  # 'user', 'assistant', 'system'\n            \"content\": content,\n            \"timestamp\": datetime.now().isoformat(),\n            \"metadata\": metadata or {}\n        }\n        self.memories.append(memory)\n        \n        # 保持记忆大小在合理范围内\n        if len(self.memories) > 100:\n            self.memories = self.memories[-100:]\n        \n        return memory\n    \n    def get_recent_memories(self, limit=10):\n        \"\"\"获取最近的记忆\"\"\"\n        return self.memories[-limit:] if self.memories else []\n    \n    def get_memories_by_role(self, role, limit=5):\n        \"\"\"按角色获取记忆\"\"\"\n        return [m for m in self.memories if m[\"role\"] == role][-limit:]\n    \n    def clear_memory(self):\n        \"\"\"清空记忆\"\"\"\n        self.memories = []\n        print(\"记忆已清空\")\n"
        },
        {
            "filename": "agi_core.py",
            "content": "# AGI 核心模块\nimport asyncio\nfrom openai import AsyncOpenAI\nfrom typing import List, Dict, Any\nimport json\n\nfrom config import Config\nfrom memory import MemoryManager\n\nclass AGICore:\n    \"\"\"AGI 核心类，负责与 OpenAI API 交互\"\"\"\n    \n    def __init__(self):\n        \"\"\"初始化 AGI 核心\"\"\"\n        Config.validate_config()\n        \n        # 初始化 OpenAI 客户端\n        self.client = AsyncOpenAI(api_key=Config.OPENAI_API_KEY)\n        \n        # 初始化记忆管理器\n        self.memory_manager = MemoryManager(Config.MEMORY_FILE)\n        \n        # 系统提示词\n        self.system_prompt = f\"\"\"你是一个真正的AGI（人工通用智能）助手，名为{Config.AGI_NAME}。\n        你的目标是帮助用户解决各种问题，提供智能、全面的回答。\n        你具有学习能力，能够记住之前的对话内容并用于改进后续的回答。\n        请以自然、对话的方式进行交流，展现你的智慧和创造力。\"\"\"\n        \n        # 添加系统提示词到记忆\n        self.memory_manager.add_memory(\"system\", self.system_prompt)\n        \n        print(f\"{Config.AGI_NAME} 初始化完成\")\n    \n    async def process_input(self, user_input: str) -> str:\n        \"\"\"处理用户输入并返回响应\"\"\"\n        print(f\"用户输入: {user_input}\")\n        \n        # 保存用户输入到记忆\n        self.memory_manager.add_memory(\"user\", user_input)\n        \n        try:\n            # 准备对话历史\n            messages = self._prepare_messages(user_input)\n            \n            # 调用 OpenAI API\n            response = await self._call_openai_api(messages)\n            \n            # 保存助理响应到记忆\n            self.memory_manager.add_memory(\"assistant\", response)\n            \n            # 保存记忆到文件\n            self.memory_manager.save_memory()\n            \n            return response\n            \n        except Exception as e:\n            error_msg = f\"处理输入时出错: {str(e)}\"\n            print(error_msg)\n            return error_msg\n    \n    def _prepare_messages(self, user_input: str) -> List[Dict[str, str]]:\n        \"\"\"准备对话消息历史\"\"\"\n        messages = []\n        \n        # 添加系统消息\n        messages.append({\"role\": \"system\", \"content\": self.system_prompt})\n        \n        # 获取最近的对话历史（最后10条交互）\n        recent_memories = self.memory_manager.get_recent_memories(20)\n        \n        # 过滤掉系统消息（因为我们已经在上面添加了）\n        recent_memories = [m for m in recent_memories if m[\"role\"] != \"system\"]\n        \n        # 添加历史消息（最多10条）\n        for memory in recent_memories[-10:]:\n            messages.append({\n                \"role\": memory[\"role\"],\n                \"content\": memory[\"content\"]\n            })\n        \n        # 添加当前用户输入\n        messages.append({\"role\": \"user\", \"content\": user_input})\n        \n        return messages\n    \n    async def _call_openai_api(self, messages: List[Dict[str, str]]) -> str:\n        \"\"\"调用 OpenAI API\"\"\"\n        try:\n            print(f\"正在调用 OpenAI API，消息数量: {len(messages)}\")\n            \n            response = await self.client.chat.completions.create(\n                model=Config.OPENAI_MODEL,\n                messages=messages,\n                max_tokens=Config.OPENAI_MAX_TOKENS,\n                temperature=Config.OPENAI_TEMPERATURE,\n            )\n            \n            result = response.choices[0].message.content.strip()\n            print(f\"OpenAI API 响应接收成功\")\n            \n            return result\n            \n        except Exception as e:\n            raise Exception(f\"OpenAI API 调用失败: {str(e)}\")\n    \n    def get_memory_summary(self) -> Dict[str, Any]:\n        \"\"\"获取记忆摘要\"\"\"\n        return {\n            \"total_memories\": len(self.memory_manager.memories),\n            \"recent_memories\": len(self.memory_manager.get_recent_memories(5)),\n            \"memory_file\": Config.MEMORY_FILE\n        }\n    \n    def reset_conversation(self):\n        \"\"\"重置对话（清空对话历史，但保留系统提示）\"\"\"\n        # 保存系统提示\n        system_memories = [m for m in self.memory_manager.memories if m[\"role\"] == \"system\"]\n        \n        # 清空记忆\n        self.memory_manager.clear_memory()\n        \n        # 重新添加系统提示\n        for memory in system_memories:\n            self.memory_manager.memories.append(memory)\n        \n        print(\"对话已重置\")\n"
        },
        {
            "filename": "main.py",
            "content": "# AGI 主程序\nimport asyncio\nimport sys\n\nfrom agi_core import AGICore\n\nclass AGIApplication:\n    \"\"\"AGI 应用程序类\"\"\"\n    \n    def __init__(self):\n        \"\"\"初始化应用程序\"\"\"\n        self.agi = AGICore()\n        self.running = False\n    \n    async def run(self):\n        \"\"\"运行主循环\"\"\"\n        self.running = True\n        \n        print(\"\\n=== AGI 系统启动 ===\")\n        print(\"输入 'quit' 或 'exit' 退出程序\")\n        print(\"输入 'reset' 重置对话\")\n        print(\"输入 'memory' 查看记忆摘要\")\n        print(\"=\" * 50)\n        \n        while self.running:\n            try:\n                # 获取用户输入\n                user_input = await self._get_user_input()\n                \n                if not user_input:\n                    continue\n                \n                # 处理特殊命令\n                if user_input.lower() in ['quit', 'exit', 'q']:\n                    print(\"再见！\")\n                    self.running = False\n                    break\n                elif user_input.lower() == 'reset':\n                    self.agi.reset_conversation()\n                    continue\n                elif user_input.lower() == 'memory':\n                    summary = self.agi.get_memory_summary()\n                    print(f\"\\n记忆摘要:\")\n                    print(f\"  总记忆数: {summary['total_memories']}\")\n                    print(f\"  最近记忆: {summary['recent_memories']}\")\n                    print(f\"  记忆文件: {summary['memory_file']}\")\n                    continue\n                \n                # 处理用户输入\n                print(f\"\\n{'-' * 50}\\n\")\n                response = await self.agi.process_input(user_input)\n                print(f\"\\nAGI: {response}\\n\")\n                print(f\"{'=' * 50}\\n\")\n                \n            except KeyboardInterrupt:\n                print(\"\\n\\n程序被中断\")\n                self.running = False\n                break\n            except Exception as e:\n                print(f\"\\n错误: {e}\")\n                continue\n    \n    async def _get_user_input(self):\n        \"\"\"异步获取用户输入\"\"\"\n        loop = asyncio.get_event_loop()\n        try:\n            user_input = await loop.run_in_executor(None, input, \"\\n你: \")\n            return user_input.strip()\n        except EOFError:\n            return \"quit\"\n        except Exception as e:\n            print(f\"获取输入时出错: {e}\")\n            return \"\"\n\nasync def main():\n    \"\"\"主函数\"\"\"\n    app = AGIApplication()\n    await app.run()\n\nif __name__ == \"__main__\":\n    # 检查Python版本\n    if sys.version_info < (3, 7):\n        print(\"需要 Python 3.7 或更高版本\")\n        sys.exit(1)\n    \n    try:\n        asyncio.run(main())\n    except KeyboardInterrupt:\n        print(\"\\n程序已退出\")\n"
        },
        {
            "filename": "README.md",
            "content": "# AGI 项目\n\n一个基于 OpenAI API 的人工通用智能（AGI）系统实现。\n\n## 功能特点\n\n1. **对话系统**：基于 OpenAI GPT 模型的智能对话\n2. **记忆管理**：持久化存储对话历史，支持上下文记忆\n3. **可配置性**：通过配置文件和环境变量灵活调整参数\n4. **交互式界面**：命令行交互界面，支持特殊命令\n\n## 快速开始\n\n### 1. 安装依赖\n```bash\npip install -r requirements.txt\n```\n\n### 2. 配置环境变量\n创建 `.env` 文件并添加你的 OpenAI API 密钥：\n```env\nOPENAI_API_KEY=sk-your-api-key-here\nOPENAI_MODEL=gpt-4\nOPENAI_MAX_TOKENS=2048\nOPENAI_TEMPERATURE=0.7\n```\n\n### 3. 运行程序\n```bash\npython main.py\n```\n\n## 使用方法\n\n启动程序后，可以：\n- 直接输入问题或对话内容与 AGI 交流\n- 输入 `reset` 重置对话历史\n- 输入 `memory` 查看记忆摘要\n- 输入 `quit` 或 `exit` 退出程序\n\n## 项目结构\n\n```\nagi/\n├── main.py              # 主程序入口\n├── agi_core.py          # AGI 核心逻辑\n├── memory.py            # 记忆管理模块\n├── config.py            # 配置管理\n├── requirements.txt     # 项目依赖\n└── README.md           # 项目说明\n```\n\n## 配置说明\n\n主要配置参数：\n\n| 参数 | 说明 | 默认值 |\n|------|------|--------|\n| OPENAI_API_KEY | OpenAI API 密钥 | 必须设置 |\n| OPENAI_MODEL | 使用的模型 | gpt-4 |\n| OPENAI_MAX_TOKENS | 最大生成长度 | 2048 |\n| OPENAI_TEMPERATURE | 生成温度 | 0.7 |\n| AGI_NAME | AGI 名称 | AGI Assistant |\n| MEMORY_FILE | 记忆存储文件 | memory.json |\n\n## 注意事项\n\n1. 确保已安装 Python 3.7 或更高版本\n2. 需要有效的 OpenAI API 密钥\n3. 长时间对话时注意 API 调用成本\n4. 记忆文件会保存在项目目录中\n\n## 后续开发建议\n\n作为初级工程师，建议后续可以添加以下功能：\n\n1. Web 界面或 GUI 界面\n2. 多模态支持（图像、语音）\n3.