# agi

```json
{
    "files": [
        {
            "filename": "README.md",
            "content": "# AGI 项目\n\n这是一个实现通用人工智能（AGI）的实验性项目，使用 OpenAI API 作为核心模型。\n\n## 项目概述\n\n该项目旨在创建一个模块化、可扩展的AGI系统，能够处理多种认知任务，包括推理、学习、规划和问题解决。\n\n## 当前功能\n\n- 基于 OpenAI GPT 模型的对话和推理能力\n- 简单的记忆系统\n- 任务分解和执行\n- 基本的外部工具调用\n\n## 环境要求\n\n- Python 3.8+\n- OpenAI API 密钥\n\n## 安装和运行\n\n1. 安装依赖：`pip install -r requirements.txt`\n2. 设置环境变量：`export OPENAI_API_KEY='your-api-key'`\n3. 运行主程序：`python main.py`\n\n## 注意事项\n\n- 这是一个研究性项目，不保证稳定性\n- 使用 OpenAI API 可能会产生费用\n- 项目处于早期开发阶段"
        },
        {
            "filename": "requirements.txt",
            "content": "openai==1.3.0\npython-dotenv==1.0.0\nnumpy==1.24.0\npydantic==2.4.0\ncolorama==0.4.6\n"
        },
        {
            "filename": ".env.example",
            "content": "# 复制此文件为 .env 并填写你的 API 密钥\nOPENAI_API_KEY=your_openai_api_key_here\nOPENAI_MODEL=gpt-4\ntemperature=0.7\n"
        },
        {
            "filename": "config.py",
            "content": "import os\nfrom dotenv import load_dotenv\nfrom pydantic import BaseSettings\n\n# 加载环境变量\nload_dotenv()\n\nclass Settings(BaseSettings):\n    \"\"\"配置类\"\"\"\n    OPENAI_API_KEY: str = os.getenv(\"OPENAI_API_KEY\", \"\")\n    OPENAI_MODEL: str = os.getenv(\"OPENAI_MODEL\", \"gpt-4\")\n    TEMPERATURE: float = float(os.getenv(\"TEMPERATURE\", 0.7))\n    MAX_TOKENS: int = 2000\n    \n    class Config:\n        env_file = \".env\"\n\nsettings = Settings()\n"
        },
        {
            "filename": "core/__init__.py",
            "content": "# AGI核心模块\n\"\"\"\nAGI核心模块，包含大脑、记忆、推理等核心组件\n\"\"\"\n"
        },
        {
            "filename": "core/brain.py",
            "content": "import openai\nimport json\nfrom typing import List, Dict, Any, Optional\nfrom datetime import datetime\nfrom config import settings\n\nclass Brain:\n    \"\"\"\n    AGI的大脑核心，负责处理推理、思考和决策\n    \"\"\"\n    \n    def __init__(self):\n        \"\"\"初始化大脑\"\"\"\n        openai.api_key = settings.OPENAI_API_KEY\n        self.model = settings.OPENAI_MODEL\n        self.temperature = settings.TEMPERATURE\n        self.memory = []  # 简单记忆存储\n        self.context_window = 10  # 上下文窗口大小\n        \n    def think(self, prompt: str, context: List[str] = None) -> Dict[str, Any]:\n        \"\"\"\n        进行思考和推理\n        \n        Args:\n            prompt: 输入提示\n            context: 上下文信息\n            \n        Returns:\n            思考结果\n        \"\"\"\n        try:\n            # 构建消息历史\n            messages = self._build_messages(prompt, context)\n            \n            # 调用OpenAI API\n            response = openai.ChatCompletion.create(\n                model=self.model,\n                messages=messages,\n                temperature=self.temperature,\n                max_tokens=settings.MAX_TOKENS\n            )\n            \n            # 提取响应\n            content = response.choices[0].message.content\n            \n            # 存储到记忆\n            self._store_memory(prompt, content)\n            \n            # 尝试解析JSON响应（如果适用）\n            try:\n                parsed_response = json.loads(content)\n                return {\n                    \"content\": content,\n                    \"parsed\": parsed_response,\n                    \"thoughts\": self._extract_thoughts(content),\n                    \"timestamp\": datetime.now().isoformat()\n                }\n            except json.JSONDecodeError:\n                return {\n                    \"content\": content,\n                    \"thoughts\": self._extract_thoughts(content),\n                    \"timestamp\": datetime.now().isoformat()\n                }\n                \n        except Exception as e:\n            return {\n                \"error\": str(e),\n                \"content\": f\"思考过程中出错: {str(e)}\",\n                \"timestamp\": datetime.now().isoformat()\n            }\n    \n    def _build_messages(self, prompt: str, context: Optional[List[str]]) -> List[Dict[str, str]]:\n        \"\"\"构建消息列表\"\"\"\n        messages = [\n            {\"role\": \"system\", \"content\": \"你是一个通用人工智能（AGI），能够处理各种复杂任务。\"}\n        ]\n        \n        # 添加上下文\n        if context:\n            for ctx in context[-self.context_window:]:\n                messages.append({\"role\": \"user\", \"content\": ctx})\n                \n        # 添加当前prompt\n        messages.append({\"role\": \"user\", \"content\": prompt})\n        \n        return messages\n    \n    def _store_memory(self, prompt: str, response: str) -> None:\n        \"\"\"存储到短期记忆\"\"\"\n        memory_entry = {\n            \"prompt\": prompt,\n            \"response\": response,\n            \"timestamp\": datetime.now().isoformat()\n        }\n        self.memory.append(memory_entry)\n        \n        # 保持记忆大小在限制内\n        if len(self.memory) > 50:\n            self.memory = self.memory[-50:]\n    \n    def _extract_thoughts(self, content: str) -> List[str]:\n        \"\"\"从响应中提取思考过程\"\"\"\n        # 这是一个简单的实现，实际应用中可能需要更复杂的逻辑\n        thoughts = []\n        lines = content.split('\\n')\n        \n        for line in lines:\n            line = line.strip()\n            if line.startswith(('思考:', '想法:', '推理:')) or ('思考：' in line):\n                thoughts.append(line)\n                \n        return thoughts if thoughts else [\"思考过程未明确标注\"]\n    \n    def get_memory_summary(self) -> List[str]:\n        \"\"\"获取记忆摘要\"\"\"\n        summaries = []\n        for i, mem in enumerate(self.memory[-10:], 1):  # 只显示最近10条\n            summary = f\"{i}. {mem['prompt'][:50]}... -> {mem['response'][:50]}...\"\n            summaries.append(summary)\n        return summaries\n    \n    def plan_and_execute(self, goal: str) -> Dict[str, Any]:\n        \"\"\"\n        计划并执行一个目标\n        \n        Args:\n            goal: 要达成的目标\n            \n        Returns:\n            执行结果\n        \"\"\"\n        # 第一步：分析目标\n        analysis = self.think(f\"分析以下目标并制定计划：{goal}\")\n        \n        # 第二步：分解任务\n        decomposition = self.think(\n            \"将以下目标分解为具体步骤：\" + goal + \n            \"\\n请以JSON格式返回，包含steps数组，每个步骤有description和expected_outcome字段\"\n        )\n        \n        # 第三步：执行计划\n        results = {\n            \"goal\": goal,\n            \"analysis\": analysis,\n            \"decomposition\": decomposition,\n            \"execution_steps\": [],\n            \"final_result\": None\n        }\n        \n        # 尝试执行分解的任务（如果解析成功）\n        if \"parsed\" in decomposition and \"steps\" in decomposition[\"parsed\"]:\n            for step in decomposition[\"parsed\"][\"steps\"]:\n                step_result = self.think(\n                    f\"执行步骤：{step.get('description', '')}\"\n                )\n                results[\"execution_steps\"].append({\n                    \"step\": step,\n                    \"result\": step_result\n                })\n                \n            # 汇总结果\n            summary = self.think(\n                f\"基于以下执行步骤，总结达成目标'{goal}'的结果：\" + \n                str(results[\"execution_steps\"])\n            )\n            results[\"final_result\"] = summary\n        \n        return results\n"
        },
        {
            "filename": "core/memory.py",
            "content": "import json\nimport pickle\nfrom typing import List, Dict, Any, Optional\nfrom datetime import datetime\nfrom pathlib import Path\n\nclass LongTermMemory:\n    \"\"\"\n    长期记忆系统，用于存储和检索重要信息\n    \"\"\"\n    \n    def __init__(self, storage_path: str = \"memory_store\"):\n        \"\"\"初始化长期记忆\"\"\"\n        self.storage_path = Path(storage_path)\n        self.storage_path.mkdir(exist_ok=True)\n        self.memories = self._load_memories()\n        \n    def _load_memories(self) -> Dict[str, Any]:\n        \"\"\"从磁盘加载记忆\"\"\"\n        memory_file = self.storage_path / \"memories.pkl\"\n        if memory_file.exists():\n            try:\n                with open(memory_file, 'rb') as f:\n                    return pickle.load(f)\n            except Exception:\n                return {\"facts\": [], \"experiences\": [], \"learnings\": []}\n        return {\"facts\": [], \"experiences\": [], \"learnings\": []}\n    \n    def save_memories(self) -> None:\n        \"\"\"保存记忆到磁盘\"\"\"\n        memory_file = self.storage_path / \"memories.pkl\"\n        with open(memory_file, 'wb') as f:\n            pickle.dump(self.memories, f)\n    \n    def add_fact(self, fact: str, category: str = \"general\") -> None:\n        \"\"\"添加事实到记忆\"\"\"\n        self.memories[\"facts\"].append({\n            \"fact\": fact,\n            \"category\": category,\n            \"timestamp\": datetime.now().isoformat()\n        })\n        self.save_memories()\n    \n    def add_experience(self, experience: Dict[str, Any]) -> None:\n        \"\"\"添加经验到记忆\"\"\"\n        self.memories[\"experiences\"].append({\n            \"experience\": experience,\n            \"timestamp\": datetime.now().isoformat()\n        })\n        self.save_memories()\n    \n    def add_learning(self, learning: str, lesson: str) -> None:\n        \"\"\"添加学习到记忆\"\"\"\n        self.memories[\"learnings\"].append({\n            \"learning\": learning,\n            \"lesson\": lesson,\n            \"timestamp\": datetime.now().isoformat()\n        })\n        self.save_memories()\n    \n    def search(self, query: str, category: Optional[str] = None) -> List[Dict[str, Any]]:\n        \"\"\"在记忆中搜索\"\"\"\n        results = []\n        \n        # 搜索事实\n        for fact in self.memories[\"facts\"]:\n            if (category is None or fact[\"category\"] == category) and query.lower() in fact[\"fact\"].lower():\n                results.append({\"type\": \"fact\", \"data\": fact})\n                \n        # 搜索学习\n        for learning in self.memories[\"learnings\"]:\n            if query.lower() in learning[\"learning\"].lower() or query.lower() in learning[\"lesson\"].lower():\n                results.append({\"type\": \"learning\", \"data\": learning})\n                \n        return results\n    \n    def get_summary(self) -> Dict[str, int]:\n        \"\"\"获取记忆摘要\"\"\"\n        return {\n            \"facts\": len(self.memories[\"facts\"]),\n            \"experiences\": len(self.memories[\"experiences\"]),\n            \"learnings\": len(self.memories[\"learnings\"])\n        }\n\nclass WorkingMemory:\n    \"\"\"\n    工作记忆，用于临时存储和操作信息\n    \"\"\"\n    \n    def __init__(self, capacity: int = 7):\n        \"\"\"初始化工作记忆\"\"\"\n        self.capacity = capacity  # 经典工作记忆容量\n        self.items = []\n        \n    def add(self, item: Any, priority: float = 1.0) -> None:\n        \"\"\"添加项目到工作记忆\"\"\"\n        self.items.append({\n            \"item\": item,\n            \"priority\": priority,\n            \"timestamp\": datetime.now()\n        })\n        # 按优先级排序，移除最低优先级的项目如果超过容量\n        self.items.sort(key=lambda x: x[\"priority\"], reverse=True)\n        if len(self.items) > self.capacity:\n            self.items = self.items[:self.capacity]\n    \n    def get(self, index: int = 0) -> Optional[Any]:\n        \"\"\"获取工作记忆中的项目\"\"\"\n        if 0 <= index < len(self.items):\n            return self.items[index][\"item\"]\n        return None\n    \n    def clear(self) -> None:\n        \"\"\"清空工作记忆\"\"\"\n        self.items = []\n    \n    def get_all(self) -> List[Dict[str, Any]]:\n        \"\"\"获取所有工作记忆项目\"\"\"\n        return self.items\n"
        },
        {
            "filename": "core/perception.py",
            "content": "import re\nfrom typing import Dict, Any, List\n\nclass PerceptionModule:\n    \"\"\"\n    感知模块，负责处理和理解输入\n    \"\"\"\n    \n    @staticmethod\n    def parse_input(user_input: str) -> Dict[str, Any]:\n        \"\"\"\n        解析用户输入，识别意图和实体\n        \n        Args:\n            user_input: 用户输入文本\n            \n        Returns:\n            解析结果\n        \"\"\"\n        result = {\n            \"raw_input\": user_input,\n            \"intent\": \"unknown\",\n            \"entities\": [],\n            \"priority\": 1.0,\n            \"requires_planning\": False\n        }\n        \n        # 识别意图\n        intent_keywords = {\n            \"question\": [\"什么\", \"为什么\", \"如何\", \"怎么\", \"?\", \"？\"],\n            \"command\": [\"执行\", \"运行\", \"计算\", \"创建\", \"编写\", \"请\", \"帮我\"],\n            \"plan\": [\"计划\", \"目标\", \"实现\", \"完成\", \"项目\"],\n            \"learn\": [\"记住\", \"学习\", \"了解\", \"知识\"],\n            \"recall\": [\"回忆\", \"记得\", \"想起\", \"之前\"]\n        }\n        \n        for intent, keywords in intent_keywords.items():\n            for keyword in keywords:\n                if keyword in user_input:\n                    result[\"intent\"] = intent\n                    break\n            if result[\"intent\"] != \"unknown\":\n               