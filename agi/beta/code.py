# agi

```json
{
    "files": [
        {
            "filename": "agi_core.py",
            "content": "# agi_core.py\n# 高级工程师实现的AGI核心框架，使用OpenAI API作为模型接口\n\nimport os\nimport time\nimport json\nfrom typing import Dict, List, Any, Optional\nimport openai\nfrom datetime import datetime\n\n# 初始化OpenAI客户端\nopenai.api_key = os.getenv('OPENAI_API_KEY')\nif not openai.api_key:\n    raise ValueError(\"OpenAI API key not found. Please set OPENAI_API_KEY environment variable.\")\n\n\nclass AGI:\n    \"\"\"\n    通用人工智能（AGI）核心类\n    使用OpenAI API作为语言模型接口\n    \"\"\"\n    \n    def __init__(self, model: str = \"gpt-4\", temperature: float = 0.7):\n        self.model = model\n        self.temperature = temperature\n        self.memory = []  # 简单的记忆存储\n        self.context_window_size = 10  # 上下文窗口大小\n        self.system_prompt = \"You are an advanced AI assistant with reasoning capabilities. Think step by step and provide comprehensive answers.\"\n        \n    def _build_prompt(self, user_input: str) -> str:\n        \"\"\"\n        构建完整的提示，包含系统提示、历史记忆和用户输入\n        \"\"\"\n        # 获取最近的记忆\n        recent_memory = self.memory[-self.context_window_size:] if self.memory else []\n        \n        # 构建完整提示\n        prompt_parts = [\n            f\"{self.system_prompt}\",\n            \"\\n\\n\" + \"\\n\".join([f\"{item['role']}: {item['content']}\" for item in recent_memory]) if recent_memory else \"\",\n            f\"\\n\\nUser: {user_input}\",\n            \"\\n\\nAssistant:\"  # 为模型输出留出空间\n        ]\n        \n        return \"\".join(prompt_parts)\n    \n    def _save_to_memory(self, role: str, content: str):\n        \"\"\"\n        将交互保存到记忆中\n        \"\"\"\n        self.memory.append({\n            'timestamp': datetime.now().isoformat(),\n            'role': role,\n            'content': content\n        })\n        \n        # 保持上下文窗口大小\n        if len(self.memory) > self.context_window_size:\n            self.memory = self.memory[-self.context_window_size:]\n    \n    def think(self, user_input: str) -> Dict[str, Any]:\n        \"\"\"\n        AGI的核心思考过程\n        \"\"\"\n        try:\n            # 构建提示\n            prompt = self._build_prompt(user_input)\n            \n            # 调用OpenAI API\n            response = openai.ChatCompletion.create(\n                model=self.model,\n                messages=[\n                    {'role': 'system', 'content': self.system_prompt},\n                    *[{ 'role': item['role'], 'content': item['content'] } for item in self.memory],\n                    {'role': 'user', 'content': user_input}\n                ],\n                temperature=self.temperature,\n                max_tokens=2048,\n                n=1,\n                stop=None,\n            )\n            \n            # 提取响应\n            assistant_response = response.choices[0].message['content'].strip()\n            \n            # 保存到记忆\n            self._save_to_memory('assistant', assistant_response)\n            \n            # 返回结构化结果\n            return {\n                'success': True,\n                'response': assistant_response,\n                'model': self.model,\n                'tokens_used': response.usage.total_tokens,\n                'timestamp': datetime.now().isoformat()\n            }\n            \n        except Exception as e:\n            error_message = f\"Error during AGI processing: {str(e)}\"\n            print(error_message)\n            self._save_to_memory('error', error_message)\n            \n            return {\n                'success': False,\n                'error': str(e),\n                'timestamp': datetime.now().isoformat()\n            }\n    \n    def reflect(self) -> Dict[str, Any]:\n        \"\"\"\n        AGI的自我反思功能\n        \"\"\"\n        reflection_prompt = f\"Based on the conversation history, analyze your performance and provide insights about your reasoning process. Consider what you did well and what could be improved.\\n\\nConversation history:\\n{json.dumps(self.memory, indent=2)}\"\n        \n        try:\n            response = openai.ChatCompletion.create(\n                model=self.model,\n                messages=[\n                    {'role': 'system', 'content': self.system_prompt},\n                    {'role': 'user', 'content': reflection_prompt}\n                ],\n                temperature=0.8,\n                max_tokens=512,\n            )\n            \n            reflection = response.choices[0].message['content'].strip()\n            self._save_to_memory('reflection', reflection)\n            \n            return {\n                'success': True,\n                'reflection': reflection,\n                'timestamp': datetime.now().isoformat()\n            }\n        \n        except Exception as e:\n            return {\n                'success': False,\n                'error': str(e),\n                'timestamp': datetime.now().isoformat()\n            }\n    \n    def reset_memory(self):\n        \"\"\"\n        重置记忆\n        \"\"\"\n        self.memory = []\n    \n    def get_memory(self) -> List[Dict[str, Any]]:\n        \"\"\"\n        获取当前记忆\n        \"\"\"\n        return self.memory.copy()\n    \n    def update_system_prompt(self, new_prompt: str):\n        \"\"\"\n        更新系统提示\n        \"\"\"\n        self.system_prompt = new_prompt\n\n\nclass AGIManager:\n    \"\"\"\n    AGI管理器 - 处理多个AGI实例和高级功能\n    \"\"\"\n    \n    def __init__(self):\n        self.agis = {}\n        self.active_sessions = {}\n    \n    def create_agi(self, name: str, model: str = \"gpt-4\", temperature: float = 0.7) -> AGI:\n        \"\"\"\n        创建新的AGI实例\n        \"\"\"\n        if name in self.agis:\n            raise ValueError(f\"AGI with name '{name}' already exists\")\n        \n        agi = AGI(model=model, temperature=temperature)\n        self.agis[name] = agi\n        return agi\n    \n    def get_agi(self, name: str) -> Optional[AGI]:\n        \"\"\"\n        获取指定名称的AGI实例\n        \"\"\"\n        return self.agis.get(name)\n    \n    def delete_agi(self, name: str):\n        \"\"\"\n        删除AGI实例\n        \"\"\"\n        if name in self.agis:\n            del self.agis[name]\n    \n    def start_session(self, agi_name: str, session_id: str):\n        \"\"\"\n        开始一个新的会话\n        \"\"\"\n        if agi_name not in self.agis:\n            raise ValueError(f\"AGI '{agi_name}' not found\")\n        \n        self.active_sessions[session_id] = agi_name\n    \n    def end_session(self, session_id: str):\n        \"\"\"\n        结束会话\n        \"\"\"\n        if session_id in self.active_sessions:\n            del self.active_sessions[session_id]\n    \n    def process_request(self, session_id: str, user_input: str) -> Dict[str, Any]:\n        \"\"\"\n        处理用户请求\n        \"\"\"\n        if session_id not in self.active_sessions:\n            return {\n                'success': False,\n                'error': 'Session not found'\n            }\n        \n        agi_name = self.active_sessions[session_id]\n        agi = self.agis[agi_name]\n        \n        return agi.think(user_input)\n\n# 使用示例\nif __name__ == \"__main__\":\n    # 创建AGI管理器\n    manager = AGIManager()\n    \n    # 创建AGI实例\n    my_agi = manager.create_agi(\"my_agi\", model=\"gpt-4\", temperature=0.7)\n    \n    # 测试基本功能\n    print(\"=== Testing Basic Functionality ===\")\n    test_inputs = [\n        \"Hello, how are you?\",\n        \"Explain quantum computing in simple terms.\",\n        \"What are the implications of AGI development?\",\n        \"Summarize the key points of the previous discussion.\"\n    ]\n    \n    for input_text in test_inputs:\n        result = my_agi.think(input_text)\n        print(f\"\\nInput: {input_text}\")\n        print(f\"Response: {result['response']}\")\n        print(f\"Tokens used: {result['tokens_used']}\")\n        \n    # 进行自我反思\n    print(\"\\n=== Reflection ===\")\n    reflection = my_agi.reflect()\n    if reflection['success']:\n        print(f\"Reflection: {reflection['reflection']}\")\n    \n    # 显示记忆\n    print(\"\\n=== Memory ===\")\n    memory = my_agi.get_memory()\n    for item in memory:\n        print(f\"{item['timestamp']} - {item['role']}: {item['content'][:100]}...\")"
        },
        {
            "filename": "requirements.txt",
            "content": "openai==0.27.0\npython-dotenv==0.19.0\n"
        },
        {
            "filename": "config.py",
            "content": "# config.py\n# 配置文件\n\nimport os\n\n# OpenAI API配置\nOPENAI_API_KEY = os.getenv('OPENAI_API_KEY')\n\n# AGI配置\nDEFAULT_MODEL = \"gpt-4\"\nDEFAULT_TEMPERATURE = 0.7\n\n# 日志配置\nLOG_LEVEL = \"INFO\"\nLOG_FILE = \"agi.log\"\n\n# 环境配置\nENVIRONMENT = os.getenv('ENVIRONMENT', 'development')"
        },
        {
            "filename": "run_agi.py",
            "content": "# run_agi.py\n# 主运行脚本\n\nimport os\nimport sys\nfrom agi_core import AGI, AGIManager\nfrom config import OPENAI_API_KEY\n\ndef main():\n    \"\"\"\n    主函数 - 启动AGI系统\n    \"\"\"\n    # 检查API密钥\n    if not OPENAI_API_KEY:\n        print(\"Error: OPENAI_API_KEY environment variable not set\")\n        print(\"Please set it before running this script\")\n        sys.exit(1)\n    \n    # 创建AGI管理器\n    manager = AGIManager()\n    \n    # 创建AGI实例\n    agi = manager.create_agi(\"default_agi\")\n    \n    print(\"AGI System Ready!\")\n    print(\"Type 'quit' to exit\")\n    print(\"Type 'reflect' to request self-reflection\")\n    print(\"Type 'memory' to view current memory\")\n    print(\"Type 'reset' to clear memory\")\n    \n    while True:\n        try:\n            user_input = input(\"\\nYou: \").strip()\n            \n            if user_input.lower() == 'quit':\n                break\n            elif user_input.lower() == 'reflect':\n                result = agi.reflect()\n                if result['success']:\n                    print(f\"AGI: {result['reflection']}\")\n                else:\n                    print(f\"Error: {result['error']}\")\n            elif user_input.lower() == 'memory':\n                memory = agi.get_memory()\n                print(\"\\nMemory History:\")\n                for item in memory:\n                    print(f\"  {item['timestamp']} [{item['role']}]: {item['content']}\")\n            elif user_input.lower() == 'reset':\n                agi.reset_memory()\n                print(\"Memory cleared.\")\n            else:\n                result = agi.think(user_input)\n                if result['success']:\n                    print(f\"AGI: {result['response']}\")\n                else:\n                    print(f\"Error: {result['error']}\")\n        \n        except KeyboardInterrupt:\n            print(\"\\nGoodbye!\")\n            break\n        except Exception as e:\n            print(f\"Error: {e}\")\n            continue\n\nif __name__ == \"__main__\":\n    main()"
        }
    ]
}
```